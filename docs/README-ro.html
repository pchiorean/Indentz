<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Indentz</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
	<style>
		body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif; font-size: 14px; line-height: 1.6; }
	</style>
	<style>
		.task-list-item { list-style-type: none; }
		.task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
	</style>
</head>

<body class="vscode-light">
	<h1 id="indentz">Indentz</h1>
	<p>Colecție de scripturi InDesign pentru operații simple și repetitive. O bună parte dintre ele sunt gândite să fie rulate printr&#x2011;un shortcut (o sugestie de configurare găsiți în secțiunea <a href="#shortcuts">Shortcuts</a>). Câteva pot fi rulate în scriptul <a href="https://creativepro.com/files/kahrel/indesign/batch_convert.html"><strong><code>batch_convert.jsx</code></strong></a> de Peter Kahrel.</p>

	<h2 id="descriere">Descriere</h2>
	<h3 id="seria-alignto">Seria <strong>AlignTo</strong></h3>
	<p>Aliniază obiectul selectat la partea de sus/jos/stânga/dreapta/centru a referinței definite de setarea <strong>Align To</strong>. Cu margini, pagină sau spread (rulați scriptul în mod repetat). <strong><code>ResetAlignTo.jsx</code></strong> resetează setarea.</p>
	<p><img src="img/alignto.png" alt="Align Panel"></p>
	<p>Ideal e să le alocați tastaturii numerice pentru o utilizare ușoară (v. [Shortcuts](#shortcuts)).</p>

	<h3 id="doccleanupjsx--docdefaultsjsx"><strong>DocCleanup.jsx</strong> / <strong>DocDefaults.jsx</strong></h3>
	<p>Sunt două scripturi gândite să fie folosite împreună – unul &quot;curăță&quot;, celălalt &quot;pregătește terenul&quot;.</p>
	<p>Ambele schimbă câteva setări după preferințele mele:</p>
	<blockquote>
		<p><strong>Rulers:</strong> Reset Zero Point <br>
			<strong>Rulers Units:</strong> Millimeters <br>
			<strong>View:</strong> Show Rulers <br>
			<strong>View:</strong> Show Frame Edges <br>
			<strong>Document Intent:</strong> Print <br>
			<strong>Transparency Blend Space:</strong> CMYK <br>
			<strong>CMYK Profile:</strong> ISO Coated v2 (ECI) <br>
			<strong>RGB Profile:</strong> sRGB IEC61966-2.1 <br>
			<strong>Grids &amp; Guides:</strong> Show Guides <br>
			<strong>Grids &amp; Guides:</strong> Unlock Guides <br>
			<strong>Guides &amp; Pasteboard: Margins:</strong> H 150 mm, V 25 mm <br>
			<strong>Guides &amp; Pasteboard: Preview Background:</strong> Light Gray <br>
			<strong>Keyboard Increments: Cursor Key:</strong> 0.2 mm <br>
			<strong>Keyboard Increments: Size/Leading:</strong> 0.5 pt <br>
			<strong>Keyboard Increments: Baseline Shift:</strong> 0.1 pt <br>
			<strong>Keyboard Increments: Kerning/Tracking:</strong> 5/1000 em <br>
			<strong>Pages:</strong> Allow Document Pages to Shuffle <br>
			<strong>Layers:</strong> Ungroup Remembers Layers <br>
			<strong>Layers:</strong> Paste Remembers Layers <br>
			<strong>Transform Reference Point:</strong> Center <br>
			<strong>Type Options:</strong> Use Typographer's Quotes <br>
			<strong>Type Options:</strong> Apply Leading to Entire Paragraphs</p>
	</blockquote>
	<ul>
		<li>
			<p><strong><code>DocDefaults.jsx</code></strong> creează câteva culori speciale și layere, înlocuiește câteva fonturi lipsă sau nedorite (rulează <strong><code>CleanupFonts.jsx</code></strong>), și stabilește geometria paginii din numele fișierului (rulează <strong><code>PageSizeFromFilename.jsx</code></strong>).</p>
			<p><img src="img/docdefaults.png" alt="Culori și layere"></p>
			<p>De asemenea, scriptul combină câteva layere similare:</p>
			<table>
				<thead>
					<tr>
						<th style="text-align:left">Layer</th>
						<th style="text-align:left">Combinat cu</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td style="text-align:left">Rahmen, Vis. area, Visible area, Visible, Vizibil</td>
						<td style="text-align:left"><code>safe area</code></td>
					</tr>
					<tr>
						<td style="text-align:left">cut lines, Cut, decoupe, die cut, diecut, Stanz, Stanze</td>
						<td style="text-align:left"><code>dielines</code></td>
					</tr>
					<tr>
						<td style="text-align:left">UV, Varnish</td>
						<td style="text-align:left"><code>varnish</code></td>
					</tr>
					<tr>
						<td style="text-align:left">HW Logo, Logo HW, hw, WH, WHW</td>
						<td style="text-align:left"><code>HW</code></td>
					</tr>
					<tr>
						<td style="text-align:left">Copy, Text, TEXT, TEXTES, TXT, Type</td>
						<td style="text-align:left"><code>text and logos</code></td>
					</tr>
					<tr>
						<td style="text-align:left">Artwork, AW, Layer 1, Calque 1, Ebene 1, Elemente, Layout, Layouts
						</td>
						<td style="text-align:left"><code>artwork</code></td>
					</tr>
					<tr>
						<td style="text-align:left">background, BACKGROUND, BG, HG, Hintergrund</td>
						<td style="text-align:left"><code>bg</code></td>
					</tr>
				</tbody>
			</table>
		</li>
		<li>
			<p><strong><code>DocCleanup.jsx</code></strong> șterge culorile, layerele și paginile neutilizate, deblochează toate elementele, le resetează scalarea la 100% și șterge toate liniile de ghidaj.</p>
		</li>
	</ul>

	<h3 id="cleanupfontsjsx"><strong>CleanupFonts.jsx</strong></h3>
	<p>Înlocuiește unele fonturi lipsă sau nedorite cu echivalentele lor. Lista este un fișier TSV <em>(tab-separated values)</em> cu 4 coloane, cu același nume ca scriptul (<a href="../cleanup/CleanupFonts.txt"><strong><code>CleanupFonts.txt</code></strong></a>). Prima linie (antetul) este ignorată.</p>
	<p>Puteți utiliza <strong><code>ShowFonts.jsx</code></strong> pentru a obține o listă cu fonturile folosite <em>(tab separated)</em>.</p>

	<h3 id="cleanuplabelsjsx"><strong>CleanupLabels.jsx</strong></h3>
	<p>Uneori se refolosesc obiecte care au o etichetă atașată <em>(Script Label)</em>, și asta poate crea probleme ulterior. <strong><code>CleanupLabels.jsx</code></strong> șterge toate etichetele din document (dacă nu e selectat nimic) sau din elementele selectate.</p>

	<h3 id="cleanupswatchesjsx"><strong>CleanupSwatches.jsx</strong></h3>
	<p>Convertește swatch&#x2011;urile RGB la CMYK, elimină duplicatele, le redenumește după formula &quot;C=&nbsp;M=&nbsp;Y=&nbsp;K=&quot; și le șterge pe cele nefolosite. Culorile spot rămân neschimbate.</p>

	<h3 id="seria-fittopage--fittospread">Seria <strong>FitToPage</strong> / <strong>FitToSpread</strong></h3>
	<p>Redimensionează unul sau mai multe obiecte selectate, fără să le scaleze. Frame&#x2011;urile obișnuite sunt redimensionate pur și simplu. Pentru a nu le deforma, obiectele rotite, ovalurile, grupurile etc sunt incluse într&#x2011;un <em>clipping frame</em> și acesta e redimensionat. Dacă rulați un script a doua oară pe un astfel de obiect, îl va restaura.</p>
	<ul>
		<li>
			<p><strong><code>FitToPage.jsx</code></strong> / <strong><code>FitToPageMargins.jsx</code></strong> / <strong><code>FitToPageBleed.jsx</code></strong> constrâng dimensiunile unui obiect la dimensiunile paginii, ale marginii sau ale bleedului paginii.</p>
		</li>
		<li>
			<p><strong><code>FitToSpread.jsx</code></strong> / <strong><code>FitToSpreadMargins.jsx</code></strong> / <strong><code>FitToSpreadBleed.jsx</code></strong> fac același lucru pentru paginile grupate într&#x2011;un spread.</p>
		</li>
		<li>
			<p><strong><code>FitToPageBleedForced.jsx</code></strong> și <strong><code>FitToPageSpreadForced.jsx</code></strong> redimensionează exact la bleedul paginii sau ale spreadului. Sunt utile, de exemplu, pentru imaginea de background.</p>
		</li>
		<li>
			<p><strong><code>FitUndo.jsx</code></strong>: dacă doriți să restaurați toate obiectele simultan.</p>
		</li>
	</ul>

	<h3 id="seria-scaletopage">Seria <strong>ScaleToPage</strong></h3>
	<p>Acestea lucrează, de asemenea, cu unul sau mai multe obiecte, dar le scalează proporțional, ca un bloc unitar.</p>
	<ul>
		<li>
			<p><strong><code>ScaleToPageSize.jsx</code></strong> și <strong><code>ScaleToPageMargins.jsx</code></strong> scalează la dimensiunile paginii sau marginii.</p>
		</li>
		<li>
			<p>Variantele <strong><code>H</code></strong> (height) și <strong><code>W</code></strong> (width) scalează la înălțimea, respectiv lățimea paginii sau marginii.</p>
		</li>
	</ul>

	<h3 id="seria-pagesize">Seria <strong>PageSize</strong></h3>
	<p>Redimensionează paginile documentului în funcție de numele fișierului, de marginile paginii, sau de obiectele selectate.</p>
	<ul>
		<li>
			<p><strong><code>PageSizeFromFilename.jsx</code></strong> caută în numele fișierului perechi de numere de genul &quot;000x000&quot; (unde &quot;000&quot; înseamnă un grup de cel puțin o cifră, urmată sau nu de zecimale, și opțional de &quot;mm&quot; sau &quot;cm&quot;). Dacă găsește doar o pereche, aceasta va fi dimensiunea paginii. Dacă găsește două (de ex. &quot;000x000_000x000&quot;), perechea mai mare va fi dimensiunea paginii, iar perechea mai mică dimensiunea ariei vizibile. Dacă sunt urmate de o secvență de una sau două cifre, aceasta e considerată bleed.</p>
			<p>Exemple:</p>
			<blockquote>
				<p>Filename1_<strong>1400x400_700x137_5</strong>mm.indd <br>
					Filename2_<strong>597x517_577x500.5_3</strong>mm V4.indd</p>
			</blockquote>
		</li>
		<li>
			<p><strong><code>PageSizeFromMargins.jsx</code></strong> redimensionează fiecare pagină la marginile acesteia.</p>
		</li>
		<li>
			<p><strong><code>PageSizeFromSelection.jsx</code></strong> redimensionează pagina curentă la obiectele selectate (similar cu <strong>Artboards &gt; Fit to Selected Art</strong> din Illustrator).</p>
		</li>
		<li>
			<p><strong><code>PageMarginsFromSelection.jsx</code></strong> setează marginile paginii la dimensiunile selecției.</p>
		</li>
	</ul>

	<h3 id="textautosizejsx"><strong>TextAutosize.jsx</strong></h3>
	<p>&quot;Strânge&quot; chenarul la text și îi setează dimensionarea automată. Puteți controla unde va fi punctul de referință pentru dimensionarea automată setând <strong>Paragraph Alignment</strong> pentru axa orizontală și <strong>Vertical Justification</strong> pentru axa verticală:</p>
	<table>
		<thead>
			<tr>
				<th style="text-align:left"><strong>Vertical Justification</strong></th>
				<th style="text-align:center"><strong>¶ Align left</strong></th>
				<th style="text-align:center"><strong>¶ Align center</strong></th>
				<th style="text-align:center"><strong>¶ Align right</strong></th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:left"><em>Top</em></td>
				<td style="text-align:center"><img src="img/textautosize-TL.png" alt="top-left"></td>
				<td style="text-align:center"><img src="img/textautosize-TC.png" alt="top-center"></td>
				<td style="text-align:center"><img src="img/textautosize-TR.png" alt="top-right"></td>
			</tr>
			<tr>
				<td style="text-align:left"><em>Center</em></td>
				<td style="text-align:center"><img src="img/textautosize-CL.png" alt="center-left"></td>
				<td style="text-align:center"><img src="img/textautosize-C.png" alt="center"></td>
				<td style="text-align:center"><img src="img/textautosize-CR.png" alt="center-right"></td>
			</tr>
			<tr>
				<td style="text-align:left"><em>Bottom</em></td>
				<td style="text-align:center"><img src="img/textautosize-BL.png" alt="bottom-left"></td>
				<td style="text-align:center"><img src="img/textautosize-BC.png" alt="bottom-center"></td>
				<td style="text-align:center"><img src="img/textautosize-BR.png" alt="bottom-right"></td>
			</tr>
		</tbody>
	</table>
	<p><strong>Auto-Sizing Type</strong> va fi setat <em>Height and width</em> dacă textul are un singur rând. Dacă are mai multe rânduri, prima rulare îl va seta <em>Height only</em>, a doua <em>Height and width</em> (caz în care trebuie avut grijă ca rândurile să fie rupte manual).</p>

	<h3 id="seria-print">Seria <strong>Print</strong></h3>
	<p>Fac câteva pregătiri pentru export și pot fi rulate în <strong><code>batch_convert.jsx</code></strong>.</p>
	<ul>
		<li>
			<p><strong><code>PrepareForPrint.jsx</code></strong> face următoarele:</p>
			<ul>
				<li>ascunde layerul <code>safe area</code>;</li>
				<li>mută marcajele pentru lac UV de pe <code>varnish</code> pe spreaduri separate;</li>
				<li>mută ștanțele de pe <code>dielines</code> pe spreaduri separate.</li>
			</ul>
		</li>
		<li>
			<p><strong><code>SafeArea.jsx</code></strong> creează un frame de dimensiunea marginilor paginii pe layerul <code>safe area</code>. Culoarea lui este un swatch, <code>Safe area</code>, care dacă nu există deja va fi creat cu valoarea &quot;C=0&nbsp;M=100&nbsp;Y=0&nbsp;K=0&quot;.</p>
		</li>
		<li>
			<p><strong><code>SafeAreaHideLayer.jsx</code></strong> și <strong><code>SafeAreaShowLayer.jsx</code></strong> ascund sau afișează <code>safe area</code>.</p>
		</li>
	</ul>
	<p>Scripturile detectează nume alternative gen <code>visible</code>, <code>vizibil</code>, <code>vis. area</code> pentru <code>safe area</code>, sau <code>diecut</code>, <code>die cut</code>, <code>cut lines</code>, <code>stanze</code> pentru <code>dielines</code>.</p>

	<h3 id="qrjsx"><strong>QR.jsx</strong></h3>
	<p>Adaugă un cod QR în colțul din stânga jos al fiecărei pagini sau îl salvează într&#x2011;un fișier separat. Are două moduri de operare, manual sau batch:</p>
	<ul>
		<li>
			<p><strong>Manual:</strong> Solicită codul și îl adaugă pe pagină sau într&#x2011;un fișier separat.</p>
		</li>
		<li>
			<p><strong>Batch:</strong> Dacă găsește un fișier numit <code>QR.txt</code> în același folder, citește codurile din el. Fișierul trebuie să fie un TSV <em>(tab-separated values)</em>; prima coloană e numele fișierului, a doua codul QR. Prima linie (antetul) e ignorată:</p>
			<table>
				<thead>
					<tr>
						<th style="text-align:left">Fișier</th>
						<th style="text-align:left">@QR</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td style="text-align:left">
							<strong><code>Filename1_1400x400_700x137_5mm_QR.indd</code></strong></td>
						<td style="text-align:left">FILE1 1400x400_700x137</td>
					</tr>
					<tr>
						<td style="text-align:left">
							<strong><code>Filename2_597x517_577x500.5_3mm V4_QR.indd</code></strong></td>
						<td style="text-align:left">FILE2 597x517_577x500.5</td>
					</tr>
				</tbody>
			</table>
		</li>
	</ul>
	<p>Puteți insera &quot;|&quot; pentru a rupe rândurile manual.</p>

	<h3 id="zoomtoselectionjsx"><strong>ZoomToSelection.jsx</strong></h3>
	<p>Asemănător cu <strong>Fit Selection in Window</strong> (⌥⌘=), dar cu câteva îmbunătățiri:</p>
	<ul>
		<li>aduce selecția puțin mai aproape;</li>
		<li>dacă cursorul e în text, face zoom la întreg cadrul;</li>
		<li>fără nimic selectat face vizibil întreg spreadul.</li>
	</ul>

	<h3 id="diverse">Diverse</h3>
	<ul>
		<li>
			<p><strong><code>PageRatios.jsx</code></strong> calculează rația fiecărei pagini și o afișează în colțul din stânga sus.</p>
		</li>
		<li>
			<p><strong><code>ShowFonts.jsx</code></strong> afișează toate fonturile utilizate în documentul curent.</p>
		</li>
		<li>
			<p><strong><code>ShowProfiles.jsx</code></strong> afișează toate profilele de culori disponibile.</p>
		</li>
		<li>
			<p><strong><code>ShowProperties.jsx</code></strong> afișează proprietățile și metodele unui obiect selectat (util pentru depanare).</p>
		</li>
	</ul>

	<h2 id="shortcuts">Shortcut&#x2011;uri</h2>
	<p>Rularea unui script folosit frecvent din panoul <strong>Scripts</strong> poate deveni obositoare, deoarece trebuie de fiecare dată să îl găsiți, apoi să faceți dublu clic pe el. Puteți face asta instantaneu, atribuindu&#x2011;i o scurtătură din <strong>Edit &gt; Keyboard Shortcuts... &gt; Product Area &gt; Scripts</strong>. Configurația mea este următoarea:</p>
	<table>
		<thead>
			<tr>
				<th style="text-align:left">Script</th>
				<th style="text-align:right">Fn</th>
				<th style="text-align:left">Script</th>
				<th style="text-align:right">Fn</th>
				<th style="text-align:left">Script</th>
				<th style="text-align:right">Fn</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:left"><strong><code>AlignToTL.jsx</code></strong></td>
				<td style="text-align:right">Num7</td>
				<td style="text-align:left"><strong><code>AlignToT.jsx</code></strong></td>
				<td style="text-align:right">Num8</td>
				<td style="text-align:left"><strong><code>AlignToTR.jsx</code></strong></td>
				<td style="text-align:right">Num9</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>AlignToL.jsx</code></strong></td>
				<td style="text-align:right">Num4</td>
				<td style="text-align:left"><strong><code>AlignToC.jsx</code></strong></td>
				<td style="text-align:right">Num5</td>
				<td style="text-align:left"><strong><code>AlignToR.jsx</code></strong></td>
				<td style="text-align:right">Num6</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>AlignToBL.jsx</code></strong></td>
				<td style="text-align:right">Num1</td>
				<td style="text-align:left"><strong><code>AlignToB.jsx</code></strong></td>
				<td style="text-align:right">Num2</td>
				<td style="text-align:left"><strong><code>AlignToBR.jsx</code></strong></td>
				<td style="text-align:right">Num3</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>ToggleAlignTo.jsx</code></strong></td>
				<td style="text-align:right">Num0</td>
				<td style="text-align:left"><strong><code>ResetAlignTo.jsx</code></strong></td>
				<td style="text-align:right">⌃Num0</td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>DocCleanup.jsx</code></strong></td>
				<td style="text-align:right">F2</td>
				<td style="text-align:left"><strong><code>DocDefaults.jsx</code></strong></td>
				<td style="text-align:right">⌥F2</td>
				<td style="text-align:left"><strong><code>CleanupSwatches.jsx</code></strong></td>
				<td style="text-align:right">⇧F2</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>FitToPage.jsx</code></strong></td>
				<td style="text-align:right">F11</td>
				<td style="text-align:left"><strong><code>FitToPageMargins.jsx</code></strong></td>
				<td style="text-align:right">⌥F11</td>
				<td style="text-align:left"><strong><code>FitToPageBleed.jsx</code></strong></td>
				<td style="text-align:right">⇧F11</td>
			</tr>
			<tr>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"><strong><code>FitToPageBleedForced.jsx</code></strong></td>
				<td style="text-align:right">⇧⌘F11</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>FitToSpread.jsx</code></strong></td>
				<td style="text-align:right">F12</td>
				<td style="text-align:left"><strong><code>FitToSpreadMargins.jsx</code></strong></td>
				<td style="text-align:right">⌥F12</td>
				<td style="text-align:left"><strong><code>FitToSpreadBleed.jsx</code></strong></td>
				<td style="text-align:right">⇧F12</td>
			</tr>
			<tr>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"><strong><code>FitToSpreadBleedForced.jsx</code></strong></td>
				<td style="text-align:right">⇧⌘F12</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>ScaleToPageSize.jsx</code></strong></td>
				<td style="text-align:right">F5</td>
				<td style="text-align:left"><strong><code>ScaleToPageMargins.jsx</code></strong></td>
				<td style="text-align:right">⌥F5</td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>TextAutosize.jsx</code></strong></td>
				<td style="text-align:right">F6</td>
				<td style="text-align:left"><strong><code>QR.jsx</code></strong></td>
				<td style="text-align:right">F9</td>
				<td style="text-align:left"><strong><code>ZoomToSelection.jsx</code></strong></td>
				<td style="text-align:right">F4</td>
			</tr>
		</tbody>
	</table>

	<h2 id="instalare">Instalare</h2>
	<ol>
		<li>Deschideți <strong>Window &gt; Utilities &gt; Scripts</strong>.</li>
		<li>Faceți clic dreapta pe folderul <strong>User</strong> și selectați <strong>Reveal in Finder/Explorer</strong>.</li>
		<li>Copiați fișierele în acest folder.</li>
	</ol>

	<h2 id="licență">Licență</h2>
	<p>Codul este publicat sub licența MIT (<a href="../LICENSE.txt">LICENSE.txt</a>). Vă rog să&#x2011;mi trimiteți un e&#x2011;mail la &lt;jpeg AT basement.ro&gt; sau să <a href="https://github.com/pchiorean/Indentz/issues">raportați o problemă</a> pe Github dacă întâmpinați probleme sau aveți sugestii.</p>
	<p>README-ro.md • 20 august 2020.</p>
</body>

</html>