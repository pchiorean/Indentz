<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Indentz</title>
	<style>
	</style>

	<link rel="stylesheet"
		href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
	<link rel="stylesheet"
		href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
			font-size: 14px;
			line-height: 1.6;
		}
	</style>
	<style>
		.task-list-item {
			list-style-type: none;
		}

		.task-list-item-checkbox {
			margin-left: -20px;
			vertical-align: middle;
		}
	</style>



</head>

<body class="vscode-light">
	<h1 id="indentz">Indentz</h1>
	<p>Collection of InDesign scripts for simple and repetitive tasks: cleaning up the document, making default layers
		and special colors, resizing objects to the page geometry or modifying it, preparing for print, better zooming.
	</p>
	<p>Many are designed to be run through a shortcut. You can found a configuration suggestion in the <a
			href="#shortcuts">Shortcuts</a> section. Some are intended to be run in the <a
			href="https://creativepro.com/files/kahrel/indesign/batch_convert.html"><strong><code>batch_convert.jsx</code></strong></a>
		script by Peter Kahrel.</p>
	<h2 id="description">Description</h2>
	<h4 id="doccleanupjsx--docdefaultsjsx"><strong><code>DocCleanup.jsx</code></strong> /
		<strong><code>DocDefaults.jsx</code></strong></h4>
	<p>These are two scripts meant to be used together – one &quot;cleans&quot;, the other &quot;prepares the
		ground&quot;.</p>
	<p>First, they change some settings according to my preferences, as follows:</p>
	<blockquote>
		<p><strong>Rulers:</strong> Reset Zero Point <br>
			<strong>Rulers Units:</strong> Millimeters <br>
			<strong>View:</strong> Show Rulers <br>
			<strong>View:</strong> Show Frame Edges <br>
			<strong>Document Intent:</strong> Print <br>
			<strong>Transparency Blend Space:</strong> CMYK <br>
			<strong>CMYK Profile:</strong> ISO Coated v2 (ECI) <br>
			<strong>RGB Profile:</strong> sRGB IEC61966-2.1 <br>
			<strong>Grids &amp; Guides:</strong> Show Guides <br>
			<strong>Grids &amp; Guides:</strong> Unlock Guides <br>
			<strong>Guides &amp; Pasteboard: Margins:</strong> H 150 mm, V 25 mm <br>
			<strong>Guides &amp; Pasteboard: Preview Background:</strong> Light Gray <br>
			<strong>Keyboard Increments: Cursor Key:</strong> 0.2 mm <br>
			<strong>Keyboard Increments: Size/Leading:</strong> 0.5 pt <br>
			<strong>Keyboard Increments: Baseline Shift:</strong> 0.1 pt <br>
			<strong>Keyboard Increments: Kerning/Tracking:</strong> 5/1000 em <br>
			<strong>Layers:</strong> Ungroup Remembers Layers <br>
			<strong>Layers:</strong> Paste Remembers Layers <br>
			<strong>Transform Reference Point:</strong> Center <br>
			<strong>Type Options:</strong> Use Typographer's Quotes <br>
			<strong>Type Options:</strong> Apply Leading to Entire Paragraphs</p>
	</blockquote>
	<p>After which:</p>
	<ul>
		<li>
			<p><strong><code>DocCleanup.jsx</code></strong> cleans up unused swatches/layers/pages, unlocks all items,
				resets their scaling to 100%, removes all guides.</p>
		</li>
		<li>
			<p><strong><code>DocDefaults.jsx</code></strong> creates some swatches &amp; layers, merges similar layers,
				replaces some missing or unwanted fonts, and sets the page geometry from the filename.</p>
			<p><img src="img/docdefaults.png"
					alt="Swatches &amp; layers"></p>
			<p>The script merges several similar layers, as follows:</p>
			<table>
				<thead>
					<tr>
						<th style="text-align:left">Layer</th>
						<th style="text-align:left">Merged to</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td style="text-align:left">Visible, visible, Vizibil, vizibil, Vis. area, vis. area, visible
							area, Visible area</td>
						<td style="text-align:left"><code>safe area</code></td>
					</tr>
					<tr>
						<td style="text-align:left">Cut, diecut, die cut, Die Cut, cut lines, stanze, Stanze, decoupe
						</td>
						<td style="text-align:left"><code>dielines</code></td>
					</tr>
					<tr>
						<td style="text-align:left">UV, Varnish</td>
						<td style="text-align:left"><code>varnish</code></td>
					</tr>
					<tr>
						<td style="text-align:left">WHW, WH, wh, hw, Hw Logo</td>
						<td style="text-align:left"><code>HW</code></td>
					</tr>
					<tr>
						<td style="text-align:left">Type, TEXT, TEXTES, Text, text, txt, copy</td>
						<td style="text-align:left"><code>type</code></td>
					</tr>
					<tr>
						<td style="text-align:left">Ebene 1, Calque 1, Artwork, AW, Layouts, Layout, layout, Layer_lucru
						</td>
						<td style="text-align:left"><code>artwork</code></td>
					</tr>
					<tr>
						<td style="text-align:left">background, BACKGROUND, BG, HG, Hintergrund</td>
						<td style="text-align:left"><code>bg</code></td>
					</tr>
				</tbody>
			</table>
		</li>
	</ul>
	<h4 id="cleanupfontsjsx"><strong><code>CleanupFonts.jsx</code></strong></h4>
	<p>Replaces some missing or unwanted fonts with equivalents from a list. The list is a 4 column TSV
		<em>(tab-separated values)</em> file with the same name as the script. The first line (the header) is ignored.
		The current list is as follows:</p>
	<table>
		<thead>
			<tr>
				<th style="text-align:left">Old Name</th>
				<th style="text-align:left">Style</th>
				<th style="text-align:left">New Name</th>
				<th style="text-align:left">Style</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:left">Akzidenz Grotesk</td>
				<td style="text-align:left">Bold</td>
				<td style="text-align:left"><strong>AkzidenzGrotesk</strong></td>
				<td style="text-align:left"><strong>Bold</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Arial</td>
				<td style="text-align:left">Bold</td>
				<td style="text-align:left"><strong>Helvetica Neue</strong></td>
				<td style="text-align:left"><strong>Bold</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">FoundryGridnik</td>
				<td style="text-align:left">Regular</td>
				<td style="text-align:left"><strong>Foundry Gridnik</strong></td>
				<td style="text-align:left"><strong>Regular</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">FoundryGridnik</td>
				<td style="text-align:left">Bold</td>
				<td style="text-align:left"><strong>Foundry Gridnik</strong></td>
				<td style="text-align:left"><strong>Bold</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">FoundryGridnik</td>
				<td style="text-align:left">Medium</td>
				<td style="text-align:left"><strong>Foundry Gridnik</strong></td>
				<td style="text-align:left"><strong>Medium</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Gotham Light</td>
				<td style="text-align:left">Regular</td>
				<td style="text-align:left"><strong>Gotham</strong></td>
				<td style="text-align:left"><strong>Light</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Gotham Book</td>
				<td style="text-align:left">Regular</td>
				<td style="text-align:left"><strong>Gotham</strong></td>
				<td style="text-align:left"><strong>Book</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Gotham Medium</td>
				<td style="text-align:left">Regular</td>
				<td style="text-align:left"><strong>Gotham</strong></td>
				<td style="text-align:left"><strong>Medium</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Gotham Bold</td>
				<td style="text-align:left">Regular</td>
				<td style="text-align:left"><strong>Gotham</strong></td>
				<td style="text-align:left"><strong>Bold</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Gotham Black</td>
				<td style="text-align:left">Regular</td>
				<td style="text-align:left"><strong>Gotham</strong></td>
				<td style="text-align:left"><strong>Black</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Helvetica Neue LT Std</td>
				<td style="text-align:left">65 Medium</td>
				<td style="text-align:left"><strong>Helvetica Neue</strong></td>
				<td style="text-align:left"><strong>Medium</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Helvetica Neue LT Std</td>
				<td style="text-align:left">75 Bold</td>
				<td style="text-align:left"><strong>Helvetica Neue</strong></td>
				<td style="text-align:left"><strong>Bold</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Trade Gothic LT Std</td>
				<td style="text-align:left">Bold Condensed No. 20</td>
				<td style="text-align:left"><strong>Trade Gothic for LS</strong></td>
				<td style="text-align:left"><strong>Bold Condensed No. 20</strong></td>
			</tr>
			<tr>
				<td style="text-align:left">Trade Gothic LT Std</td>
				<td style="text-align:left">Condensed No. 18</td>
				<td style="text-align:left"><strong>Trade Gothic for LS</strong></td>
				<td style="text-align:left"><strong>Condensed No. 18</strong></td>
			</tr>
		</tbody>
	</table>
	<p>You can use <strong><code>ShowFonts.jsx</code></strong> to get a tab delimited list of used fonts.</p>
	<h4 id="cleanuplabelsjsx"><strong><code>CleanupLabels.jsx</code></strong></h4>
	<p>Sometimes objects that have a label attached <em>(Script Label)</em> are reused, which potentially creates
		problems later. <strong><code>CleanupLabels.jsx</code></strong> deletes all labels from a document.</p>
	<h4 id="cleanupswatchesjsx"><strong><code>CleanupSwatches.jsx</code></strong></h4>
	<p>Converts RGB process colors to CMYK, removes duplicates, sets every name in &quot;C= M= Y= K=&quot; form and
		deletes unused swatches. Spot colors remain unchanged.</p>
	<!-- ![](img/cleanupswatches.gif) -->
	<h4 id="fittopage--fittospread-series"><strong><code>FitToPage</code></strong> /
		<strong><code>FitToSpread</code></strong> series</h4>
	<p>Resize one or more selected objects, without scaling them. Ordinary frames are simply resized. In order not to
		deform them, rotated objects, ovals, groups, etc. are clipped in a frame and this is resized. If you run the
		script a second time on such an object, it will restore it.</p>
	<ul>
		<li>
			<p><strong><code>FitToPage.jsx</code></strong> / <strong><code>FitToPageMargins.jsx</code></strong> /
				<strong><code>FitToPageBleed.jsx</code></strong> constrain the size of an object to the size of the
				page, the page margins, or the page bleed.</p>
		</li>
		<li>
			<p><strong><code>FitToSpread.jsx</code></strong> / <strong><code>FitToSpreadMargins.jsx</code></strong> /
				<strong><code>FitToSpreadBleed.jsx</code></strong> do the same for pages grouped in a spread.</p>
		</li>
		<li>
			<p><strong><code>FitToPageBleedForced.jsx</code></strong> and
				<strong><code>FitToPageSpreadForced.jsx</code></strong> resize exactly to the page or the spread bleed.
				They are useful, for example, for the background image.</p>
		</li>
		<li>
			<p><strong><code>FitUndo.jsx</code></strong>: if you want to restore all objects at once.</p>
		</li>
	</ul>
	<!-- ![](img/fittopage.gif) -->
	<h4 id="scaletopage-series"><strong><code>ScaleToPage</code></strong> series</h4>
	<p>These also work with one or more objects, but scale them proportionally, as a block.</p>
	<ul>
		<li>
			<p><strong><code>ScaleToPageSize.jsx</code></strong> and
				<strong><code>ScaleToPageMargins.jsx</code></strong> scale to the page size or page margins.</p>
		</li>
		<li>
			<p>The <strong><code>H</code></strong> (height) and <strong><code>W</code></strong> (width) variants scale
				to the height or width of the page or page margins.</p>
		</li>
	</ul>
	<!-- ![](img/scaletopage.gif) -->
	<h4 id="pagesize-series"><strong><code>PageSize</code></strong> series</h4>
	<p>Resize the pages of the document based on the file name, page margins, or selected objects.</p>
	<ul>
		<li>
			<p><strong><code>PageSizeFromFilename.jsx</code></strong> searches the file name for pairs of numbers like
				&quot;000x000&quot; (where &quot;000&quot; means a group of at least one digit, followed or not by
				decimals, and optionally by &quot;mm&quot; or &quot;cm&quot;). If only one pair is found, it will be the
				size of the page. If two are found (e.g., &quot;000x000_000x000&quot;), the larger pair will be the page
				size, the smaller pair the visible/safe area size. If followed by a one- or two-digit sequence, this is
				considered bleed.</p>
			<p>Examples:</p>
			<blockquote>
				<p>Filename1_<strong>1400x400_700x137_5</strong>mm.indd <br>
					Filename2_<strong>597x517_577x500.5_3</strong>mm V4.indd</p>
			</blockquote>
		</li>
		<li>
			<p><strong><code>PageSizeFromMargins.jsx</code></strong> resizes each page to its margins.</p>
		</li>
		<li>
			<p><strong><code>PageSizeFromSelection.jsx</code></strong> resizes the current page to the selected objects
				(similar to <strong>Artboards &gt; Fit to Selected Art</strong> in Illustrator).</p>
		</li>
	</ul>
	<h4 id="pagemarginsfromselectionjsx"><strong><code>PageMarginsFromSelection.jsx</code></strong></h4>
	<p>Sets the page margins to the selected objects.</p>
	<h4 id="textautosize-series"><strong><code>TextAutosize</code></strong> series</h4>
	<p>Fit the frame to the text and set auto-sizing, vertical justification and paragraph alignment:</p>
	<ul>
		<li>
			<p><strong><code>TextAutosize.jsx</code></strong>: <em>Auto-Sizing: center. Vertical Justification: center.
					Paragraph: align center.</em></p>
		</li>
		<li>
			<p><strong><code>TextAutosizeL.jsx</code></strong>: <em>Auto-Sizing: top-left. Vertical Justification: top.
					Paragraph: align left.</em></p>
		</li>
		<li>
			<p><strong><code>TextAutosizeR.jsx</code></strong>: <em>Auto-Sizing: top-right. Vertical Justification: top.
					Paragraph: align right.</em></p>
		</li>
	</ul>
	<p><em>Auto-Sizing Type</em> will be set to <em>Height and width</em> if the text has only one line. If it has
		multiple lines, the first run will set it to <em>Height only</em>, the second run to <em>Height and width</em>
		(in which case care must be taken that the text is broken manually).</p>
	<!-- ![](img/textautosize.gif) -->
	<h4 id="print-series"><strong>Print</strong> series</h4>
	<p>These are making some preparations for export and can be run in <strong><code>batch_convert.jsx</code></strong>.</p>
	<ul>
		<li>
			<p><strong><code>PrepareForPrint.jsx</code></strong> does the following:</p>
			<ul>
				<li>hides the <code>safe area</code> layer;</li>
				<li>moves UV markings from <code>varnish</code> to separate spreads;</li>
				<li>moves the dielines from <code>dielines</code> to separate spreads.</li>
			</ul>
		</li>
		<li>
			<p><strong><code>SafeArea.jsx</code></strong> creates a frame the size of the page margins on the
				<code>safe area</code> layer. Its color is a swatch, <code>Safe area</code>, which if it does not
				already exist will be created with the value &quot;C=0 M=100 Y=0 K=0&quot;.</p>
		</li>
		<li>
			<p><strong><code>SafeAreaHideLayer.jsx</code></strong> and
				<strong><code>SafeAreaShowLayer.jsx</code></strong> hide or show <code>safe area</code>.</p>
		</li>
	</ul>
	<p>The scripts detect alternative layer names like <code>visible</code>, <code>vizibil</code>,
		<code>vis. area</code> for <code>safe area</code>, or <code>diecut</code>, <code>die cut</code>,
		<code>cut lines</code>, <code>stanze</code> for <code>dielines</code>.</p>
	<h4 id="zoomtoselectionjsx"><strong><code>ZoomToSelection.jsx</code></strong></h4>
	<p>Similar to <strong>Fit Selection in Window</strong> (⌥⌘=), but with some improvements:</p>
	<ul>
		<li>brings the selection a little closer;</li>
		<li>if the cursor is in the text, zooms on the whole frame;</li>
		<li>without anything selected zooms on the spread.</li>
	</ul>
	<h4 id="miscellaneous">Miscellaneous</h4>
	<ul>
		<li>
			<p><strong><code>PageRatios.jsx</code></strong> calculates the ratio of each page and displays it in the
				upper left corner.</p>
		</li>
		<li>
			<p><strong><code>QR.jsx</code></strong> adds a QR code on the bottom left corner of each page, or saves it
				in a separate file. It has two operating modes, batch or manual:</p>
			<ul>
				<li>
					<p>Batch: if a file named <code>QR.txt</code> is found in the same folder, it processes it. It must
						be a 2 column TSV <em>(tab-separated values)</em> file; the first column is the filename, the
						second the QR code. The first line (the header) is ignored.</p>
				</li>
				<li>
					<p>Manually: otherwise, it asks for the QR text and adds the code on the page or a separate file,
						depending on a switch.</p>
				</li>
			</ul>
		</li>
		<li>
			<p><strong><code>ShowFonts.jsx</code></strong> shows all fonts used in the current document.</p>
		</li>
		<li>
			<p><strong><code>ShowProfiles.jsx</code></strong> shows all color profiles available to InDesign.</p>
		</li>
		<li>
			<p><strong><code>ShowProperties.jsx</code></strong> shows properties and methods of a selected object
				(useful for debugging).</p>
		</li>
	</ul>
	<h2 id="shortcuts">Shortcuts</h2>
	<table>
		<thead>
			<tr>
				<th style="text-align:left">Script</th>
				<th style="text-align:right">Fn</th>
				<th style="text-align:left">Script</th>
				<th style="text-align:right">Fn</th>
				<th style="text-align:left">Script</th>
				<th style="text-align:right">Fn</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:left"><strong><code>DocCleanup.jsx</code></strong></td>
				<td style="text-align:right">F2</td>
				<td style="text-align:left"><strong><code>DocDefaults.jsx</code></strong></td>
				<td style="text-align:right">⌥F2</td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>FitToPage.jsx</code></strong></td>
				<td style="text-align:right">F11</td>
				<td style="text-align:left"><strong><code>FitToPageMargins.jsx</code></strong></td>
				<td style="text-align:right">⌥F11</td>
				<td style="text-align:left"><strong><code>FitToPageBleed.jsx</code></strong></td>
				<td style="text-align:right">⇧F11</td>
			</tr>
			<tr>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"><strong><code>FitToPageBleedForced.jsx</code></strong></td>
				<td style="text-align:right">⇧⌘F11</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>FitToSpread.jsx</code></strong></td>
				<td style="text-align:right">F12</td>
				<td style="text-align:left"><strong><code>FitToSpreadMargins.jsx</code></strong></td>
				<td style="text-align:right">⌥F12</td>
				<td style="text-align:left"><strong><code>FitToSpreadBleed.jsx</code></strong></td>
				<td style="text-align:right">⇧F12</td>
			</tr>
			<tr>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"><strong><code>FitToSpreadBleedForced.jsx</code></strong></td>
				<td style="text-align:right">⇧⌘F12</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>ScaleToPageSize.jsx</code></strong></td>
				<td style="text-align:right">F5</td>
				<td style="text-align:left"><strong><code>ScaleToPageMargins.jsx</code></strong></td>
				<td style="text-align:right">⌥F5</td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>TextAutosize.jsx</code></strong></td>
				<td style="text-align:right">F6</td>
				<td style="text-align:left"><strong><code>TextAutosizeL.jsx</code></strong></td>
				<td style="text-align:right">⌥F6</td>
				<td style="text-align:left"><strong><code>TextAutosizeR.jsx</code></strong></td>
				<td style="text-align:right">⌘F6</td>
			</tr>
			<tr>
				<td style="text-align:left"><strong><code>ZoomToSelection.jsx</code></strong></td>
				<td style="text-align:right">F4</td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
				<td style="text-align:left"></td>
				<td style="text-align:right"></td>
			</tr>
		</tbody>
	</table>
	<!-- ![](img/shortcuts.png) -->
	<h2 id="installation">Installation</h2>
	<ol>
		<li>Open <strong>Window &gt; Utilities &gt; Scripts</strong>.</li>
		<li>Right-click on folder <strong>User</strong> and select <strong>Reveal in Finder/Explorer</strong>.</li>
		<li>Copy files to this folder.</li>
	</ol>
	<h2 id="license">License</h2>
	<p>Some of the code contained in this repository is based on blog posts, forum posts, or tutorials by Dave Saunders,
		Marc Autret, Peter Werner, Richard Harrington, and Peter Kahrel. The rest of the code is released under the MIT
		License (see <a href="../LICENSE.txt">LICENSE.txt</a>).</p>
	<p>Please send me an e-mail at &lt;jpeg AT basement.ro&gt; or <a
			href="https://github.com/pchiorean/Indentz/issues">report an issue on Github</a> if you encounter problems
		or have any suggestions.</p>
	<p>README.md • 20 July 2020, 20:13 (UTC).</p>

</body>

</html>