<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Indentz</title>
<style>
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
font-size: 14px;
line-height: 1.6;
}
</style>
<style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>



</head>
<body class="vscode-light">
<h1 id="indentz">Indentz</h1>
<p>Collection of InDesign scripts for simple and repetitive tasks. Many are designed to be run through a shortcut (you can found a configuration suggestion in the <a href="#shortcuts">Shortcuts</a> section). Some are intended to be run in the <a href="https://creativepro.com/files/kahrel/indesign/batch_convert.html"><strong><code>batch_convert.jsx</code></strong></a> script by Peter Kahrel.</p>
<h2 id="description">Description</h2>
<h3 id="alignment"><strong>Alignment/Proxy</strong></h3>
<p><strong><code>AlignTo</code></strong> scripts align the selected object(s) to the <strong>Align To</strong> setting:</p>
<p><img src="img/alignto.png" alt="Align Panel"></p>
<p><strong><code>ToggleAlignTo.jsx</code></strong> toggles the alignment between item, margins, page or spread (just run it repeatedly). <strong><code>ResetAlignTo.jsx</code></strong> resets the setting to <strong>Align to Selection</strong>.</p>
<p><strong><code>SetRefPoint</code></strong> scripts change the reference point used for transformations (like clicking the little proxy squares in the <strong>Transform</strong> palette):</p>
<p><img src="img/setrefpoint.png" alt="Transform Panel"></p>
<p><strong>Note:</strong> Both sets should be assigned to the numeric keypad (see <a href="#shortcuts">Shortcuts</a>).</p>
<h3 id="fitting"><strong>Fitting</strong></h3>
<p><strong><code>FitToPage</code></strong> scripts resize the selected object(s), without scaling them: if the object is larger than the page/margins/bleed, it will be reduced; if it is smaller but inside a 5% &quot;snap&quot; area, it will be enlarged. Ordinary frames are simply resized. In order not to deform them, rotated objects, ovals, groups, etc. are clipped in a frame which is resized. <strong><code>FitToSpread</code></strong> do the same for pages grouped in a spread.</p>
<p><strong><code>FitTo...Forced.jsx</code></strong> resize exactly to the named dimensions.</p>
<p><strong><code>TextAutosize.jsx</code></strong> fits the frame to the text and sets it to auto-size. You control the auto-sizing reference point by setting <strong>Paragraph Alignment</strong> for the horizontal axis, and <strong>Text Frame Options &gt; Vertical Justification</strong> for the vertical axis:</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"><img src="img/paragraphalign-L.png" alt="¶ Align left"></th>
<th style="text-align:center"><img src="img/paragraphalign-C.png" alt="¶ Align center"></th>
<th style="text-align:center"><img src="img/paragraphalign-R.png" alt="¶ Align right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="img/verticaljustification-T.png" alt="Vertical Justification Top"></td>
<td style="text-align:center"><img src="img/textautosize-TL.png" alt="top-left"></td>
<td style="text-align:center"><img src="img/textautosize-TC.png" alt="top-center"></td>
<td style="text-align:center"><img src="img/textautosize-TR.png" alt="top-right"></td>
</tr>
<tr>
<td style="text-align:center"><img src="img/verticaljustification-C.png" alt="Vertical Justification Center"></td>
<td style="text-align:center"><img src="img/textautosize-CL.png" alt="center-left"></td>
<td style="text-align:center"><img src="img/textautosize-C.png" alt="center"></td>
<td style="text-align:center"><img src="img/textautosize-CR.png" alt="center-right"></td>
</tr>
<tr>
<td style="text-align:center"><img src="img/verticaljustification-B.png" alt="Vertical Justification Bottom"></td>
<td style="text-align:center"><img src="img/textautosize-BL.png" alt="bottom-left"></td>
<td style="text-align:center"><img src="img/textautosize-BC.png" alt="bottom-center"></td>
<td style="text-align:center"><img src="img/textautosize-BR.png" alt="bottom-right"></td>
</tr>
</tbody>
</table>
<p>If the text has only one line, <strong>Auto-Sizing Type</strong> will be set to <em>Height and width</em>. If it has multiple lines, the first run will set it to <em>Height only</em>, the second run to <em>Height and width</em>.</p>
<h3 id="scaling"><strong>Scaling</strong></h3>
<p>These also work with one or more objects, but scale them proportionally, as a block.</p>
<p><strong><code>ScaleToPageSize.jsx</code></strong> and <strong><code>ScaleToPageMargins.jsx</code></strong> scale to the page size or page margins. The <strong><code>H</code></strong> (height) and <strong><code>W</code></strong> (width) variants scale to the height or width of the page or page margins.</p>
<h3 id="print"><strong>Print</strong></h3>
<p>Make several preparations for export and can be used with <a href="https://creativepro.com/files/kahrel/indesign/batch_convert.html"><strong><code>batch_convert.jsx</code></strong></a>. The scripts detect alternative layers like <em>visible</em>, <em>vizibil</em> for <code>safe area</code>, or <em>diecut</em>, <em>die cut</em>, <em>cut lines</em>, <em>stanze</em> for <code>dielines</code>.</p>
<p><strong><code>PrepareForPrint.jsx</code></strong> hides the <code>safe area</code> layer and moves the dielines, white and UV markings from <code>dielines</code>/<code>white</code>/<code>varnish</code> to separate spreads.</p>
<p><strong><code>SafeArea.jsx</code></strong> creates a frame the size of the page margins on the <code>safe area</code> layer. It uses the <code>Safe area</code> swatch, which if it does not exist will be created with the value &quot;C=0 M=100 Y=0 K=0&quot;.</p>
<p><strong><code>SafeAreaHideLayer.jsx</code></strong> and <strong><code>SafeAreaShowLayer.jsx</code></strong> hide or show <code>safe area</code>.</p>
<h3 id="setup"><strong>Setup</strong></h3>
<p><strong><code>DocCleanup.jsx</code></strong> cleans up unused swatches/layers/pages, unlocks all items, resets their scaling to 100%.</p>
<p><strong><code>DocDefaults.jsx</code></strong> creates several swatches &amp; layers, replaces some fonts (it runs <strong><code>ReplaceFonts.jsx</code></strong>, see below), and sets the page size and margins (it runs <strong><code>PageSizeFromFilename.jsx</code></strong>).</p>
<p><img src="img/docdefaults-swatches.png" alt="Swatches"> <img src="img/docdefaults-layers.png" alt="Layers"></p>
<p>It also merges several layers:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Layer</th>
<th style="text-align:left">Merged to</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">rahmen, vis. area, visible, visible area, vizibil</td>
<td style="text-align:left"><code>safe area</code></td>
</tr>
<tr>
<td style="text-align:left">cut, cut lines, decoupe, die, die cut, diecut, stanz, stanze, stanzform</td>
<td style="text-align:left"><code>dielines</code></td>
</tr>
<tr>
<td style="text-align:left">uv, varnish</td>
<td style="text-align:left"><code>varnish</code></td>
</tr>
<tr>
<td style="text-align:left">info copy, ratio</td>
<td style="text-align:left"><code>info</code></td>
</tr>
<tr>
<td style="text-align:left">hw logo, logo hw, wh, whw</td>
<td style="text-align:left"><code>hw</code></td>
</tr>
<tr>
<td style="text-align:left">copy, text, textes, txt, type</td>
<td style="text-align:left"><code>text and logos</code></td>
</tr>
<tr>
<td style="text-align:left">tins</td>
<td style="text-align:left"><code>products</code></td>
</tr>
<tr>
<td style="text-align:left">artwork, aw, elemente, layout, layouts</td>
<td style="text-align:left"><code>artwork</code></td>
</tr>
<tr>
<td style="text-align:left">background, bg, hg, hintergrund</td>
<td style="text-align:left"><code>bg</code></td>
</tr>
</tbody>
</table>
<p>Both scripts change some settings according to my preferences.</p>
<blockquote>
<details><summary>Details</summary>
<p><strong>Rulers:</strong> Reset Zero Point <br>
<strong>Rulers Units:</strong> Millimeters <br>
<strong>View:</strong> Show Rulers <br>
<strong>View:</strong> Show Frame Edges <br>
<strong>Document Intent:</strong> Print <br>
<strong>Transparency Blend Space:</strong> CMYK <br>
<strong>CMYK Profile:</strong> ISO Coated v2 (ECI) <br>
<strong>RGB Profile:</strong> sRGB IEC61966-2.1 <br>
<strong>Grids &amp; Guides:</strong> Show Guides <br>
<strong>Grids &amp; Guides:</strong> Unlock Guides <br>
<strong>Guides &amp; Pasteboard: Margins:</strong> H 150 mm, V 25 mm <br>
<strong>Guides &amp; Pasteboard: Preview Background:</strong> Light Gray <br>
<strong>Keyboard Increments: Cursor Key:</strong> 0.2 mm <br>
<strong>Keyboard Increments: Size/Leading:</strong> 0.5 pt <br>
<strong>Keyboard Increments: Baseline Shift:</strong> 0.1 pt <br>
<strong>Keyboard Increments: Kerning/Tracking:</strong> 5/1000 em <br>
<strong>Pages:</strong> Allow Document Pages to Shuffle <br>
<strong>Layers:</strong> Ungroup Remembers Layers <br>
<strong>Layers:</strong> Paste Remembers Layers <br>
<strong>Transform Reference Point:</strong> Center <br>
<strong>Type Options:</strong> Use Typographer's Quotes <br>
<strong>Type Options:</strong> Apply Leading to Entire Paragraphs</p>
</details>
</blockquote>
<p><strong><code>CleanupSwatches.jsx</code></strong> converts RGB process swatches to CMYK, removes duplicates, renames them to &quot;C= M= Y= K=&quot; form, and deletes unused ones. Spot colors remain unchanged.</p>
<p><strong><code>ReplaceFonts.jsx</code></strong> replaces fonts from a substitution list. The list is a 4 column TSV <em>(tab-separated values)</em> file with the same name as the script (<a href="../setup/ReplaceFonts.txt"><strong><code>ReplaceFonts.txt</code></strong></a>). The first line (the header) and lines beginning with &quot;;&quot; are ignored. You can use <strong><code>ShowFonts.jsx</code></strong> from <strong>Misc</strong> to get a tab delimited list of fonts for copy-pasting in <strong><code>ReplaceFonts.txt</code></strong>.</p>
<p><strong><code>PageMarginsFromSelection.jsx</code></strong> sets the page margins to the selected objects.</p>
<p><strong><code>PageSizeFromFilename.jsx</code></strong> resizes the pages of the document according to the file name:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Filename</th>
<th style="text-align:center">Total size</th>
<th style="text-align:center">Safe area</th>
<th style="text-align:center">Bleed</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Filename1_<code>1400x400</code>_<code>700x137</code>_<code>10</code>mm_QR.indd</strong></td>
<td style="text-align:center">1400x400</td>
<td style="text-align:center">700x137</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:left"><strong>Filename2_<code>597x517</code>_<code>577x500.5</code>_<code>3</code>mm V4_QR.indd</strong></td>
<td style="text-align:center">597x517</td>
<td style="text-align:center">577x500.5</td>
<td style="text-align:center">3</td>
</tr>
</tbody>
</table>
<blockquote>
<details><summary>Details</summary>
<p>It searches for pairs of numbers like &quot;000x000&quot; (where &quot;000&quot; means a group of at least one digit, followed or not by decimals, and optionally by &quot;mm&quot; or &quot;cm&quot;). If only one pair is found, it will be the size of the page. If two are found (e.g., &quot;000x000_000x000&quot;), the larger pair will be the page size, the smaller pair the visible/safe area size. If followed by a one- or two-digit sequence, this is considered bleed.</p>
</details>
</blockquote>
<p><strong><code>PageSizeFromMargins.jsx</code></strong> resizes each page to its margins.</p>
<p><strong><code>PageSizeFromSelection.jsx</code></strong> resizes the current page to the selected objects (similar to <strong>Artboards &gt; Fit to Selected Art</strong> in Illustrator).</p>
<h3 id="misc"><strong>Misc</strong></h3>
<p><strong><code>CleanupLabels.jsx</code></strong>: sometimes objects that have a label attached <em>(Script Label)</em> are reused, which may create problems later. <strong><code>CleanupLabels.jsx</code></strong> deletes all labels from the document (if nothing is selected), or from the selected items.</p>
<p><strong><code>Clip.jsx</code></strong>: To manipulate some objects it can sometimes be useful to temporarily insert them into a container (clipping frame). <strong><code>Clip.jsx</code></strong> embeds selected objects in a clipping frame or restores them if already clipped. <strong><code>ClipUndo.jsx</code></strong> restores one or several clipped objects at once.</p>
<p><strong><code>PageRatios.jsx</code></strong> calculates the ratio of each page and displays it in the upper left corner.</p>
<p><strong><code>QR.jsx</code></strong> adds a QR code on the bottom left corner of each page, or saves it in a separate file. It has two operating modes:</p>
<ul>
<li>
<p><strong>Manually:</strong> It prompts for the QR text and adds the code on the page (or in a separate file).</p>
</li>
<li>
<p><strong>Batch:</strong> If a file named <strong><code>QR.txt</code></strong> is found in the same folder, the script will generate QR files with the data from it. This must be a 2 column TSV <em>(tab-separated values)</em> file; the first column is the QR filename, the second the code. The first line (the header) and lines beginning with &quot;;&quot; are ignored:</p>
<table>
<thead>
<tr>
<th style="text-align:left">QR Filename</th>
<th style="text-align:left">QR Code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Filename1_1400x400_700x137_10mm_QR.indd</strong></td>
<td style="text-align:left">FILE1 1400x400_700x137</td>
</tr>
<tr>
<td style="text-align:left"><strong>Filename2_597x517_577x500.5_3mm V4_QR.indd</strong></td>
<td style="text-align:left">FILE2 597x517_577x500.5 V4</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p><strong>Note:</strong> You can use &quot;|&quot; for manually splitting the text into several lines.</p>
<p><strong><code>ShowFonts.jsx</code></strong> shows all fonts used in the current document (useful with <strong><code>ReplaceFonts.jsx</code></strong>).</p>
<p><strong><code>ShowProfiles.jsx</code></strong> shows all color profiles available to InDesign (for when you <em>think</em> you have a color profile installed).</p>
<p><strong><code>ShowProperties.jsx</code></strong> shows properties and methods of a selected object (useful for debugging).</p>
<p><strong><code>ZoomToSelection.jsx</code></strong> resembles <strong>Fit Selection in Window</strong> (⌥⌘=), but with some improvements:</p>
<ul>
<li>brings the selection a little closer;</li>
<li>if the cursor is in the text, zooms on the whole frame;</li>
<li>without anything selected zooms on the spread.</li>
</ul>
<h2 id="shortcuts">Shortcuts</h2>
<p>Running a frequently used script from the <strong>Scripts</strong> panel is quite annoying. You can make the process instantaneous by assigning keyboard shortcuts from <strong>Edit &gt; Keyboard Shortcuts... &gt; Product Area &gt; Scripts</strong>:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Alignment</th>
<th style="text-align:right"></th>
<th style="text-align:left">Proxy</th>
<th style="text-align:right"></th>
<th style="text-align:left">Fitting/Scale</th>
<th style="text-align:right"></th>
<th style="text-align:left">Setup</th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><code>AlignToTL.jsx</code></strong></td>
<td style="text-align:right">Num7</td>
<td style="text-align:left"><strong><code>SetRefPointTL.jsx</code></strong></td>
<td style="text-align:right">⌃Num7</td>
<td style="text-align:left"><strong><code>FitToPage.jsx</code></strong></td>
<td style="text-align:right">F11</td>
<td style="text-align:left"><strong><code>DocCleanup.jsx</code></strong></td>
<td style="text-align:right">F2</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToL.jsx</code></strong></td>
<td style="text-align:right">Num4</td>
<td style="text-align:left"><strong><code>SetRefPointL.jsx</code></strong></td>
<td style="text-align:right">⌃Num4</td>
<td style="text-align:left"><strong><code>FitToPageMargins.jsx</code></strong></td>
<td style="text-align:right">⌥F11</td>
<td style="text-align:left"><strong><code>DocDefaults.jsx</code></strong></td>
<td style="text-align:right">⌥F2</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToBL.jsx</code></strong></td>
<td style="text-align:right">Num1</td>
<td style="text-align:left"><strong><code>SetRefPointBL.jsx</code></strong></td>
<td style="text-align:right">⌃Num1</td>
<td style="text-align:left"><strong><code>FitToPageBleed.jsx</code></strong></td>
<td style="text-align:right">⇧F11</td>
<td style="text-align:left"><strong><code>CleanupSwatches.jsx</code></strong></td>
<td style="text-align:right">⇧F2</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToT.jsx</code></strong></td>
<td style="text-align:right">Num8</td>
<td style="text-align:left"><strong><code>SetRefPointT.jsx</code></strong></td>
<td style="text-align:right">⌃Num8</td>
<td style="text-align:left"><strong><code>FitToPageBleedForced.jsx</code></strong></td>
<td style="text-align:right">⇧⌘F11</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToC.jsx</code></strong></td>
<td style="text-align:right">Num5</td>
<td style="text-align:left"><strong><code>SetRefPointC.jsx</code></strong></td>
<td style="text-align:right">⌃Num5</td>
<td style="text-align:left"><strong><code>FitToSpread.jsx</code></strong></td>
<td style="text-align:right">F12</td>
<td style="text-align:left"><strong>Misc</strong></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToB.jsx</code></strong></td>
<td style="text-align:right">Num2</td>
<td style="text-align:left"><strong><code>SetRefPointB.jsx</code></strong></td>
<td style="text-align:right">⌃Num2</td>
<td style="text-align:left"><strong><code>FitToSpreadMargins.jsx</code></strong></td>
<td style="text-align:right">⌥F12</td>
<td style="text-align:left"><strong><code>Clip.jsx</code></strong></td>
<td style="text-align:right">Num*</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToTR.jsx</code></strong></td>
<td style="text-align:right">Num9</td>
<td style="text-align:left"><strong><code>SetRefPointTR.jsx</code></strong></td>
<td style="text-align:right">⌃Num9</td>
<td style="text-align:left"><strong><code>FitToSpreadBleed.jsx</code></strong></td>
<td style="text-align:right">⇧F12</td>
<td style="text-align:left"><strong><code>QR.jsx</code></strong></td>
<td style="text-align:right">F9</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToR.jsx</code></strong></td>
<td style="text-align:right">Num6</td>
<td style="text-align:left"><strong><code>SetRefPointR.jsx</code></strong></td>
<td style="text-align:right">⌃Num6</td>
<td style="text-align:left"><strong><code>FitToSpreadBleedForced.jsx</code></strong></td>
<td style="text-align:right">⇧⌘F12</td>
<td style="text-align:left"><strong><code>ZoomToSelection.jsx</code></strong></td>
<td style="text-align:right">F4</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AlignToBR.jsx</code></strong></td>
<td style="text-align:right">Num3</td>
<td style="text-align:left"><strong><code>SetRefPointBR.jsx</code></strong></td>
<td style="text-align:right">⌃Num3</td>
<td style="text-align:left"><strong><code>ScaleToPageSize.jsx</code></strong></td>
<td style="text-align:right">F5</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>ToggleAlignTo.jsx</code></strong></td>
<td style="text-align:right">Num0</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
<td style="text-align:left"><strong><code>ScaleToPageMargins.jsx</code></strong></td>
<td style="text-align:right">⌥F5</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>ResetAlignTo.jsx</code></strong></td>
<td style="text-align:right">⌃Num0</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
<td style="text-align:left"><strong><code>TextAutosize.jsx</code></strong></td>
<td style="text-align:right">F6</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h2 id="installation">Installation</h2>
<ol>
<li>Open <strong>Window &gt; Utilities &gt; Scripts</strong>.</li>
<li>Right-click on folder <strong>User</strong> and select <strong>Reveal in Finder/Explorer</strong>.</li>
<li>Copy files to this folder.</li>
</ol>
<h2 id="license">License</h2>
<!-- Some of the code contained in this repository is based on blog posts, forum posts, or tutorials by Marc Autret, Dave Saunders, Peter Kahrel, Peter Werner, Richard Harrington and others. -->
<p>The code is released under the MIT License (see <a href="../LICENSE.txt">LICENSE.txt</a>). Send an e-mail to Paul Chiorean &lt;jpeg AT basement.ro&gt; or <a href="https://github.com/pchiorean/Indentz/issues">report an issue</a> on Github if you encounter problems or have any suggestions.</p>
<p>README.md • November 2, 2020</p>

</body>
</html>