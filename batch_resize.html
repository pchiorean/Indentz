<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Batch resize v7.20j</title>
        <style>
</style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        
        
    </head>
    <body class="vscode-light">
        <h1 id="batch-resize-v720j">Batch resize v7.20j</h1>
<p>Acest script automatizează declinarea unui master pe baza unui tabel cu informații.</p>
<h2 id="pregătire">Pregătire</h2>
<p>Avem un fișier InDesign, denumit în continuare <em>master</em>, în care fiecare pagină e un vizual cu un anumit raport (rație). Nu contează dacă sunt în ordine, paginile vor fi sortate automat în funcție de rații.</p>
<p>În același folder cu masterul trebuie pregătit un fișier text cu același nume, exportat din Excel cu opțiunea <em>tab delimited</em>, conținând opt coloane:</p>
<table>
<thead>
<tr>
<th style="text-align:center"><code>ID</code></th>
<th style="text-align:right"><code>Vizibil W</code></th>
<th style="text-align:right"><code>Vizibil H</code></th>
<th style="text-align:right"><code>Total W</code></th>
<th style="text-align:right"><code>Total H</code></th>
<th style="text-align:right"><code>Raport</code></th>
<th style="text-align:center"><code>Vizual</code></th>
<th style="text-align:left"><code>Denumire</code></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong><code>1</code></strong></td>
<td style="text-align:right"><code>200</code></td>
<td style="text-align:right"><code>600</code></td>
<td style="text-align:right"><code>230</code></td>
<td style="text-align:right"><code>620</code></td>
<td style="text-align:right"><code>0.333</code></td>
<td style="text-align:center"><code>L1</code></td>
<td style="text-align:left"><strong><code>01_Denumire_Layout1_230x620_200x600</code></strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><code>2</code></strong></td>
<td style="text-align:right"><code>206</code></td>
<td style="text-align:right"><code>421</code></td>
<td style="text-align:right"><code>230</code></td>
<td style="text-align:right"><code>440</code></td>
<td style="text-align:right"><code>0.489</code></td>
<td style="text-align:center"><code>L3</code></td>
<td style="text-align:left"><strong><code>02_Denumire_Layout3_230x440_421x230</code></strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><code>3</code></strong></td>
<td style="text-align:right"><code>205</code></td>
<td style="text-align:right"><code>297</code></td>
<td style="text-align:right"><code>230</code></td>
<td style="text-align:right"><code>320</code></td>
<td style="text-align:right"><code>0.690</code></td>
<td style="text-align:center"><code>L2</code></td>
<td style="text-align:left"><strong><code>03_Denumire_Layout2_230x320_297x230</code></strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><code>4</code></strong></td>
<td style="text-align:right"><code>310</code></td>
<td style="text-align:right"><code>300</code></td>
<td style="text-align:right"><code>320</code></td>
<td style="text-align:right"><code>305</code></td>
<td style="text-align:right"><code>1.033</code></td>
<td style="text-align:center"><code>L1</code></td>
<td style="text-align:left"><strong><code>04_Denumire_Layout1_320x305_300x320</code></strong></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:right"><code>420</code></td>
<td style="text-align:right"><code>210</code></td>
<td style="text-align:right"><code>440</code></td>
<td style="text-align:right"><code>230</code></td>
<td style="text-align:right"><code>2.000</code></td>
<td style="text-align:center"></td>
<td style="text-align:left"><strong><code>Denumire_440x230_420x210</code></strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><code>6</code></strong></td>
<td style="text-align:right"><code>598</code></td>
<td style="text-align:right"><code>210</code></td>
<td style="text-align:right"><code>620</code></td>
<td style="text-align:right"><code>220</code></td>
<td style="text-align:right"><code>2.848</code></td>
<td style="text-align:center"><code>L2</code></td>
<td style="text-align:left"><strong><code>07_Denumire_Layout2_620x220_598x210</code></strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><code>7</code></strong></td>
<td style="text-align:right"><code>985</code></td>
<td style="text-align:right"><code>210</code></td>
<td style="text-align:right"><code>1200</code></td>
<td style="text-align:right"><code>225</code></td>
<td style="text-align:right"><code>4.690</code></td>
<td style="text-align:center"><code>L2</code></td>
<td style="text-align:left"><strong><code>08_Denumire_Layout2_1200x225_985x210</code></strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><code>8</code></strong></td>
<td style="text-align:right"><code>985</code></td>
<td style="text-align:right"><code>105</code></td>
<td style="text-align:right"><code>1200</code></td>
<td style="text-align:right"><code>125</code></td>
<td style="text-align:right"><code>9.381</code></td>
<td style="text-align:center"><code>L3</code></td>
<td style="text-align:left"><strong><code>09_Denumire_Layout3_1200x125_985x105</code></strong></td>
</tr>
<tr>
<td style="text-align:center"><strong><code>9</code></strong></td>
<td style="text-align:right"><code>292</code></td>
<td style="text-align:right"><code>210</code></td>
<td style="text-align:right"><code>320</code></td>
<td style="text-align:right"><code>230</code></td>
<td style="text-align:right">1<code>.390</code></td>
<td style="text-align:center"><code>L1</code></td>
<td style="text-align:left"><strong><code>10_Denumire_Layout1_320x230_292x210</code></strong></td>
</tr>
</tbody>
</table>
<p><strong><code>ID</code></strong>: Textul va fi formatat cu &quot;Helvetica Neue Light&quot; 5 pt și va fi poziționat în partea din stânga-jos a paginii sau, dacă nu încape, a ariei vizibile. Dacă nu se dorește ID se lasă celula goală.</p>
<p><strong><code>Vizibil W/H</code></strong> și <strong><code>Total W/H</code></strong>: După cum e de bănuit, conțin dimensiunea vizibilă și totală. :) <!-- Scriptul le compară și, dacă sunt trecute invers în tabel (se întâmplă), le tratează corect. Numele fișierului însă va rămâne cel din **Denumire**. --></p>
<p><strong><code>Raport</code></strong>: Informația e preluată din Excel, dar aici nu e folosită.</p>
<p><strong><code>Vizual</code></strong>: Opțional masterul poate să conțină un set de layere cu layout-uri alternative (de ex. Layout 1/Layout 2, Valora/Denner, D/F/I, etc). Scriptul preia din coloana <code>Vizual</code> setul de layere și, pentru fiecare fișier, îl va exporta doar pe cel care apare în coloană. De exemplu, în <code>04_Denumire_Layout1_320x305_300x320</code> vor fi șterse <code>L2</code> și <code>L3</code> și va rămâne <code>L1</code>. Restul layerelor rămân neatinse. <br>
Dacă coloana e goală, masterul nu e modificat în nici un fel.</p>
<p><strong><code>Denumire</code></strong>: Fișierele vor avea exact denumirea din coloană, deci atenție la caractere ilegale în nume de fișiere.</p>
<p>E recomandat să se creeze cât mai multe pagini în master, pentru a acoperi toate rațiile de care este nevoie. E mai util să se folosească rațiile reale din tabel, în loc de rații generice gen <code>0.5</code>, <code>1</code>, <code>1.5</code>, <code>2</code> ... <code>4.5</code> ș.a.m.d. Scriptul lucrează cu trei zecimale, pentru cazuri în care avem multe fișiere cu rații foarte apropiate, care cer ulterior multe ajustări manuale minore (de genul 25 de fișiere cu rația <code>0.331</code>, 50 de fișiere cu rația <code>0.333</code> și 30 de fișiere cu rația <code>0.335</code>). TL;DR: Un master cu 20 de pagini e ok. :) Oricum trebuie declinate manual formatele mai ciudate, mai bine în master, pentru că ar putea fi eventual refolosite.</p>
<h3 id="layere-tehnice">Layere tehnice</h3>
<p>Deasupra layerelor care compun vizualul vor fi create, dacă nu există deja, layerele <code>id</code>, <code>info</code> și <code>safe area</code>, care la execuție vor fi populate cu:</p>
<ul>
<li>ID-ul, poziționat în stânga-jos a paginii;</li>
<li>info box, un text cu geometria paginii (total/vizibil/rație), poziționat dreapta-sus, pe pasteboard;</li>
<li>un chenar care marchează aria vizibilă; culoarea lui este un swatch, <code>Safe area</code>, care dacă nu există deja va fi creat cu valoarea <code>C=0 M=100 Y=0 K=0</code>.</li>
</ul>
<p>Dacă există deja un layer cu numele <code>vizibil</code> va fi folosit acesta în loc de <code>safe area</code>.</p>
<h3 id="alinieri-automate">Alinieri automate</h3>
<p>Anumite elemente pot fi aliniate automat prin etichetarea lor prealabilă din <strong>Windows &gt; Utilities &gt; Script label</strong>. Sunt posibile următoarele etichete:</p>
<ul>
<li><code>alignL, alignR, alignT, alignB</code> – aliniat la aria vizibilă la stânga, dreapta, sus, jos;</li>
<li><code>alignTL, alignBL, alignTR, alignBR</code> – aliniat stânga-sus, stânga-jos, dreapta-sus, dreapta-jos;</li>
<li><code>alignC, alignCh, alignCv</code> – aliniat la centru, centrat pe orizontală, centrat pe verticală;</li>
<li><code>fit</code> – marginile care depășesc bleed-ul sunt restrânse la acesta;</li>
<li><code>bleed</code> – toate marginile vor fi restrânse/extinse la bleed.</li>
</ul>
<p>Dacă se dorește &quot;resetarea&quot; masterului se pot șterge toate etichetele cu ajutorul scriptului <strong>remove_labels.jsx</strong>.</p>
<h2 id="execuție">Execuție</h2>
<p>Pentru fiecare rând din tabel scriptul va alege din master pagina cu rația cea mai apropiată, o va scala la <code>Vizibil W</code> × <code>Vizibil H</code> și o va extinde la <code>Total W</code> × <code>Total H</code>. Dacă e cazul, va activa layoutul din coloana <code>Vizual</code>. Va plasa ID-ul, info box-ul, chenarul pentru aria vizibilă și va alinia elementele etichetate. Va salva fișierul cu numele din <code>Denumire</code> într-un subfolder cu numele rației folosite.</p>

    </body>
    </html>